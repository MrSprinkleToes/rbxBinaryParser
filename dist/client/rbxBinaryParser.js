var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{J:()=>d});const r={1:"String",2:"Bool",3:"Int",4:"Float",5:"Double",6:"Udim",7:"Udim2",8:"Ray",9:"Faces",10:"Axes",11:"BrickColor",12:"Color3",13:"Vector2",14:"Vector3",15:"Vector2int16",16:"CFrame",17:"CFrameQuat",18:"Token",19:"Reference",20:"Vector3int16",21:"NumberSequence",22:"ColorSequence",23:"NumberRange",24:"Rect",25:"PhysicalProperties",26:"Color3uint8",27:"Int64",28:"SharedString",29:null,30:"Optional",31:"UniqueId",32:"Font"},n=[[1,0,0],[0,1,0],[0,0,1],[-1,0,0],[0,-1,0],[0,0,-1]];function o(e,t,r,n){const o=new Array(r),i=4*r;for(let a=0;a<r;a++){let s=e.getUint8(t+a)<<24;s+=e.getUint8(t+(a+r)%i)<<16,s+=e.getUint8(t+(a+2*r)%i)<<8,s+=e.getUint8(t+(a+3*r)%i),o[a]=n?n(s):s}return o}function i(e,t,r){return o(e,t,r,(e=>e%2==1?-(e+1)/2:e/2))}function a(e,t){var r=e.getUint32(t,!0),n="";for(let o=0;o<r;o++)n+=String.fromCharCode(e.getUint8(t+4+o));return[n,r]}function s(e,t,r){return i(e,t,r)}function f(e,t,r){return o(e,t,r,(e=>function(e){const t=e>>>24;if(0===t)return 0;const r=2**(t-127)*(1+(e>>>1&8388607)/8388607);return 1&e?-r:r}(e)))}function l(e,t,o){const s=e.getUint8(t),l=r[s];var c=[];switch(l){case"String":var u=0;for(let r=0;r<o;r++){const[n,o]=a(e,t+1+u);c[r]=n,u+=o+4}break;case"Bool":for(let r=0;r<o;r++)c[r]=1===e.getUint8(t+1+r);break;case"Int":c=i(e,t+1,o);break;case"Float":c=f(e,t+1,o);break;case"Double":case"UDim":case"UDim2":case"Ray":case"Faces":case"Axes":case"BrickColor":case"Color3":case"Vector2":case"Vector2int16":break;case"Vector3":const r=f(e,t+1,o),s=f(e,t+1+4*o,o),l=f(e,t+1+8*o,o);for(let e=0;e<o;e++)c[e]={x:r[e],y:s[e],z:l[e]};break;case"CFrame":u=0;for(let r=0;r<o;r++){var g=[0,0,0,0,0,0,0,0,0,0,0,0];const o=e.getUint8(t+1+u);if(u+=1,0!=o){const e=n[Math.floor((o-1)/6)],t=n[Math.floor(o-1)%6],r=[e[1]*t[2]-t[1]*e[2],e[2]*t[0]-t[2]*e[0],e[0]*t[1]-t[0]*e[1]];for(let n=0;n<3;n++)g[3+3*n]=e[n],g[4+3*n]=t[n],g[5+3*n]=r[n]}else for(let n=0;n<9;n++)g[r+3]=e.getUint32(t+1+u),u+=4}const h=f(e,t+1+u,o),d=f(e,t+1+u+4*o,o),U=f(e,t+1+u+8*o,o);for(let e=0;e<o;e++)c[e]={Position:{x:h[e],y:d[e],z:U[e]},Components:g};break;default:c=null}return{type:l,values:c}}let c=function(e,t){return(void 0===e.outputBuffer||e.outputBuffer.byteLength<t)&&(e.outputBuffer=new ArrayBuffer(t+65535&2147418112)),e.outputBuffer};function u(){this.hashTable=void 0,this.outputBuffer=void 0}function g(e,t){const r=[String.fromCharCode(e.getUint8(t+0)),String.fromCharCode(e.getUint8(t+1)),String.fromCharCode(e.getUint8(t+2)),String.fromCharCode(e.getUint8(t+3))].join(""),n=e.getUint32(t+4,!0),o=e.getUint32(t+8,!0),i=0==n?o:n,a=new Uint8Array(i);for(var s=0;s<i;s++)a[s]=e.getUint8(t+16+s);return{signature:r,compressedLength:n,uncompressedLength:o,dataLength:i,payload:0!=n?u.prototype.decodeBlock(a,0,o):a}}u.prototype={flavor:"js",init:function(){return Promise.resolve()},reset:function(){this.hashTable=void 0,this.outputBuffer=void 0},bytesInUse:function(){let e=0;return void 0!==this.hashTable&&(e+=this.hashTable.byteLength),void 0!==this.outputBuffer&&(e+=this.outputBuffer.byteLength),e},encodeBlock:function(e,t){if(e instanceof ArrayBuffer)e=new Uint8Array(e);else if(e instanceof Uint8Array==0)throw new TypeError;return function(e,t,r){let n=t.byteLength;if(n>=2113929216)throw new RangeError;let o=n-12,i=n-5;void 0===e.hashTable&&(e.hashTable=new Int32Array(65536)),e.hashTable.fill(-65536),t instanceof ArrayBuffer&&(t=new Uint8Array(t));let a=r+((s=n)>2113929216?0:s+(s/255|0)+16);var s;let f=new Uint8Array(c(e,a),0,a),l=0,u=r,g=0;for(;;){let r,n,a=t[l]<<8|t[l+1]<<16|t[l+2]<<24;for(;l<=o;){a=a>>>8|t[l+3]<<24;let o=(40503*a&65535)+(31153*a>>>16)&65535;if(r=e.hashTable[o],e.hashTable[o]=l,n=l-r,n<65536&&t[r+0]===(255&a)&&t[r+1]===(a>>>8&255)&&t[r+2]===(a>>>16&255)&&t[r+3]===(a>>>24&255))break;l+=1}if(l>o)break;let s=l-g,c=l;for(l+=4,r+=4;l<i&&t[l]===t[r];)l+=1,r+=1;c=l-c;let h=c<19?c-4:15;if(s>=15){f[u++]=240|h;let e=s-15;for(;e>=255;)f[u++]=255,e-=255;f[u++]=e}else f[u++]=s<<4|h;for(;s--;)f[u++]=t[g++];if(0===c)break;if(f[u+0]=n,f[u+1]=n>>>8,u+=2,c>=19){let e=c-19;for(;e>=255;)f[u++]=255,e-=255;f[u++]=e}g=l}let h=n-g;if(h>=15){f[u++]=240;let e=h-15;for(;e>=255;)f[u++]=255,e-=255;f[u++]=e}else f[u++]=h<<4;for(;h--;)f[u++]=t[g++];return new Uint8Array(f.buffer,0,u)}(this,e,t)},decodeBlock:function(e,t,r){if(e instanceof ArrayBuffer)e=new Uint8Array(e);else if(e instanceof Uint8Array==0)throw new TypeError;return function(e,t,r,n){let o=t.byteLength,i=new Uint8Array(c(e,n),0,n),a=r,s=0;for(;a<o;){let e=t[a++],r=e>>>4;if(0!==r){if(15===r){let e;for(;e=t[a++],255===e;)r+=255;r+=e}let e=a+r;for(;a<e;)i[s++]=t[a++];if(a===o)break}let n=t[a+0]|t[a+1]<<8;if(0===n||n>s)return;if(a+=2,r=4+(15&e),19===r){let e;for(;e=t[a++],255===e;)r+=255;r+=e}let f=s-n,l=s+r;for(;s<l;)i[s++]=i[f++]}return i}(this,e,t,r)}};const h=[60,114,111,98,108,111,120,33,137,255,13,10,26,10];function d(e){const t=performance.now(),r=new DataView(e);for(var n=0,o=0;o<e.byteLength;o++)if(r.getUint8(o)==h[0]){n=o;break}var i,f,c=[];for(o=0;o<14;o++)c.push(r.getUint8(o+n));console.assert((f=h,(i=c).length==f.length&&(i.forEach(((e,t)=>{if(e!=f[t])return!1})),!0)),"Invalid file signature."),console.log("Valid file signature.");var u=n+14,d=r.getUint16(u,!0);console.log("Version:",d);var U=u+2,y={classCount:r.getUint32(U,!0),instanceCount:r.getUint32(U+4,!0)};console.log("Header:",y);for(var b=U+16,p={},v=[],m=[],C=[];b<e.byteLength&&"END\0"!==p.signature;){b+=16+(p=g(r,b)).dataLength;const e=new DataView(p.payload.buffer);if("META"==p.signature){const t=e.getUint32(0,!0),r=[];var w=4;for(let n=0;n<t;n++){const[t,n]=a(e,w);w+=n+4;const[o,i]=a(e,w);w+=i+4,r.push({key:t,value:o})}}else if("SSTR"==p.signature);else if("INST"==p.signature){const t=e.getInt32(0,!0),[r,n]=a(e,4),o=(e.getUint8(8+n,!0),e.getUint32(8+n+1,!0)),i=s(e,8+n+1+4,o),f=[];for(let t=0;t<o;t++)f.push(e.getUint8(8+n+1+4+o+t));m[t]={className:r,instances:[]};var k=0;for(let e=0;e<o;e++)v[k+=i[e]]={ClassName:r,Children:[]},m[t].instances.push(k)}else if("PROP"==p.signature){const t=e.getInt32(0,!0),[r,n]=a(e,4),o=l(e,8+n,m[t].instances.length);if(o.values)for(let e=0;e<m[t].instances.length;e++)v[m[t].instances[e]][r]=o.values[e]}else if("PRNT"==p.signature){const t=e.getUint32(1,!0),r=s(e,5,t),n=s(e,5+4*t,t);var B=0,A=0;for(let e=0;e<t;e++){B+=r[e],A+=n[e];const t=v[B];A<0?C[B]=t:v[A].Children.push(t)}}}return console.log("Finished decoding file.\nTime elapsed:",performance.now()-t,"ms"),C}var U=t.J;export{U as decode};